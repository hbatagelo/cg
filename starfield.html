<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9.5 Efeito starfield | MCTA008-17 Computação Gráfica</title>
  <meta name="description" content="Notas de aula de MCTA008-17 Computação Gráfica da Universidade Federal do ABC" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="9.5 Efeito starfield | MCTA008-17 Computação Gráfica" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Notas de aula de MCTA008-17 Computação Gráfica da Universidade Federal do ABC" />
  <meta name="github-repo" content="hbatagelo/cgbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9.5 Efeito starfield | MCTA008-17 Computação Gráfica" />
  
  <meta name="twitter:description" content="Notas de aula de MCTA008-17 Computação Gráfica da Universidade Federal do ABC" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="viewer1.html"/>
<link rel="next" href="referências.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { font-weight: bold; } /* Alert */
code span.an { font-style: italic; } /* Annotation */
code span.cf { font-weight: bold; } /* ControlFlow */
code span.co { font-style: italic; } /* Comment */
code span.cv { font-style: italic; } /* CommentVar */
code span.do { font-style: italic; } /* Documentation */
code span.dt { text-decoration: underline; } /* DataType */
code span.er { font-weight: bold; } /* Error */
code span.in { font-style: italic; } /* Information */
code span.kw { font-weight: bold; } /* Keyword */
code span.pp { font-weight: bold; } /* Preprocessor */
code span.wa { font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Computação Gráfica</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> | Notas de aula</a>
<ul>
<li class="chapter" data-level="" data-path="pré-requisitos.html"><a href="pré-requisitos.html"><i class="fa fa-check"></i>Pré-requisitos</a>
<ul>
<li class="chapter" data-level="" data-path="pré-requisitos.html"><a href="pré-requisitos.html#atividades-práticas"><i class="fa fa-check"></i>Atividades práticas</a></li>
<li class="chapter" data-level="" data-path="pré-requisitos.html"><a href="pré-requisitos.html#visualizando-este-site"><i class="fa fa-check"></i>Visualizando este site</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="config.html"><a href="config.html"><i class="fa fa-check"></i><b>2</b> Configuração do ambiente</a>
<ul>
<li class="chapter" data-level="2.1" data-path="linux.html"><a href="linux.html"><i class="fa fa-check"></i><b>2.1</b> Linux</a>
<ul>
<li class="chapter" data-level="" data-path="linux.html"><a href="linux.html#verificando-o-opengl"><i class="fa fa-check"></i>Verificando o OpenGL</a></li>
<li class="chapter" data-level="" data-path="linux.html"><a href="linux.html#atualizando-o-gcc"><i class="fa fa-check"></i>Atualizando o GCC</a></li>
<li class="chapter" data-level="" data-path="linux.html"><a href="linux.html#instalando-o-emscripten"><i class="fa fa-check"></i>Instalando o Emscripten</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="macos.html"><a href="macos.html"><i class="fa fa-check"></i><b>2.2</b> macOS</a>
<ul>
<li class="chapter" data-level="" data-path="macos.html"><a href="macos.html#instalando-o-emscripten-1"><i class="fa fa-check"></i>Instalando o Emscripten</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="windows.html"><a href="windows.html"><i class="fa fa-check"></i><b>2.3</b> Windows</a>
<ul>
<li class="chapter" data-level="" data-path="windows.html"><a href="windows.html#verificando-o-opengl-1"><i class="fa fa-check"></i>Verificando o OpenGL</a></li>
<li class="chapter" data-level="" data-path="windows.html"><a href="windows.html#instalando-o-emscripten-2"><i class="fa fa-check"></i>Instalando o Emscripten</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="vscode.html"><a href="vscode.html"><i class="fa fa-check"></i><b>2.4</b> Visual Studio Code</a></li>
<li class="chapter" data-level="2.5" data-path="abcg.html"><a href="abcg.html"><i class="fa fa-check"></i><b>2.5</b> ABCg</a>
<ul>
<li class="chapter" data-level="" data-path="abcg.html"><a href="abcg.html#instalação"><i class="fa fa-check"></i>Instalação</a></li>
<li class="chapter" data-level="" data-path="abcg.html"><a href="abcg.html#compilando-na-linha-de-comando"><i class="fa fa-check"></i>Compilando na linha de comando</a></li>
<li class="chapter" data-level="" data-path="abcg.html"><a href="abcg.html#compilando-no-vs-code"><i class="fa fa-check"></i>Compilando no VS Code</a></li>
<li class="chapter" data-level="" data-path="abcg.html"><a href="abcg.html#depurando-no-vs-code"><i class="fa fa-check"></i>Depurando no VS Code</a></li>
<li class="chapter" data-level="" data-path="abcg.html"><a href="abcg.html#compilando-para-wasm"><i class="fa fa-check"></i>Compilando para WASM</a></li>
<li class="chapter" data-level="" data-path="abcg.html"><a href="abcg.html#revisão-de-c"><i class="fa fa-check"></i>Revisão de C++</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>3</b> Introdução</a>
<ul>
<li class="chapter" data-level="3.1" data-path="áreas-correlatas.html"><a href="áreas-correlatas.html"><i class="fa fa-check"></i><b>3.1</b> Áreas correlatas</a></li>
<li class="chapter" data-level="3.2" data-path="linha-do-tempo.html"><a href="linha-do-tempo.html"><i class="fa fa-check"></i><b>3.2</b> Linha do tempo</a>
<ul>
<li class="chapter" data-level="" data-path="linha-do-tempo.html"><a href="linha-do-tempo.html#section"><i class="fa fa-check"></i>1950</a></li>
<li class="chapter" data-level="" data-path="linha-do-tempo.html"><a href="linha-do-tempo.html#section-1"><i class="fa fa-check"></i>1960</a></li>
<li class="chapter" data-level="" data-path="linha-do-tempo.html"><a href="linha-do-tempo.html#section-2"><i class="fa fa-check"></i>1970</a></li>
<li class="chapter" data-level="" data-path="linha-do-tempo.html"><a href="linha-do-tempo.html#section-3"><i class="fa fa-check"></i>1980</a></li>
<li class="chapter" data-level="" data-path="linha-do-tempo.html"><a href="linha-do-tempo.html#section-4"><i class="fa fa-check"></i>1990</a></li>
<li class="chapter" data-level="" data-path="linha-do-tempo.html"><a href="linha-do-tempo.html#section-5"><i class="fa fa-check"></i>2000</a></li>
<li class="chapter" data-level="" data-path="linha-do-tempo.html"><a href="linha-do-tempo.html#section-6"><i class="fa fa-check"></i>2010</a></li>
<li class="chapter" data-level="" data-path="linha-do-tempo.html"><a href="linha-do-tempo.html#section-7"><i class="fa fa-check"></i>2020</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="firstapp.html"><a href="firstapp.html"><i class="fa fa-check"></i><b>3.3</b> Primeiro programa</a>
<ul>
<li class="chapter" data-level="" data-path="firstapp.html"><a href="firstapp.html#configuração-inicial"><i class="fa fa-check"></i>Configuração inicial</a></li>
<li class="chapter" data-level="" data-path="firstapp.html"><a href="firstapp.html#main.cpp"><i class="fa fa-check"></i>main.cpp</a></li>
<li class="chapter" data-level="" data-path="firstapp.html"><a href="firstapp.html#window.hpp"><i class="fa fa-check"></i>window.hpp</a></li>
<li class="chapter" data-level="" data-path="firstapp.html"><a href="firstapp.html#window.cpp"><i class="fa fa-check"></i>window.cpp</a></li>
<li class="chapter" data-level="" data-path="firstapp.html"><a href="firstapp.html#compilando-para-webassembly"><i class="fa fa-check"></i>Compilando para WebAssembly</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="tictactoe.html"><a href="tictactoe.html"><i class="fa fa-check"></i><b>3.4</b> Jogo da Velha</a>
<ul>
<li class="chapter" data-level="" data-path="tictactoe.html"><a href="tictactoe.html#configuração-inicial-1"><i class="fa fa-check"></i>Configuração inicial</a></li>
<li class="chapter" data-level="" data-path="tictactoe.html"><a href="tictactoe.html#main.cpp-1"><i class="fa fa-check"></i>main.cpp</a></li>
<li class="chapter" data-level="" data-path="tictactoe.html"><a href="tictactoe.html#window.hpp-1"><i class="fa fa-check"></i>window.hpp</a></li>
<li class="chapter" data-level="" data-path="tictactoe.html"><a href="tictactoe.html#window.cpp-1"><i class="fa fa-check"></i>window.cpp</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="graphicssystem.html"><a href="graphicssystem.html"><i class="fa fa-check"></i><b>4</b> Sistemas gráficos</a>
<ul>
<li class="chapter" data-level="4.1" data-path="lightcolor.html"><a href="lightcolor.html"><i class="fa fa-check"></i><b>4.1</b> Luz e cor</a>
<ul>
<li class="chapter" data-level="" data-path="lightcolor.html"><a href="lightcolor.html#visão-tricromática"><i class="fa fa-check"></i>Visão tricromática</a></li>
<li class="chapter" data-level="" data-path="lightcolor.html"><a href="lightcolor.html#modelos-de-cor"><i class="fa fa-check"></i>Modelos de cor</a></li>
<li class="chapter" data-level="" data-path="lightcolor.html"><a href="lightcolor.html#sistema-cie-1931"><i class="fa fa-check"></i>Sistema CIE 1931</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="vectorxraster.html"><a href="vectorxraster.html"><i class="fa fa-check"></i><b>4.2</b> Vetorial <em>x</em> matricial</a>
<ul>
<li class="chapter" data-level="" data-path="vectorxraster.html"><a href="vectorxraster.html#representação-vetorial"><i class="fa fa-check"></i>Representação vetorial</a></li>
<li class="chapter" data-level="" data-path="vectorxraster.html"><a href="vectorxraster.html#representação-matricial"><i class="fa fa-check"></i>Representação matricial</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="es.html"><a href="es.html"><i class="fa fa-check"></i><b>4.3</b> Dispositivos de E/S</a>
<ul>
<li class="chapter" data-level="" data-path="es.html"><a href="es.html#dispositivos-de-entrada"><i class="fa fa-check"></i>Dispositivos de entrada</a></li>
<li class="chapter" data-level="" data-path="es.html"><a href="es.html#dispositivos-de-saída"><i class="fa fa-check"></i>Dispositivos de saída</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="framebuffer.html"><a href="framebuffer.html"><i class="fa fa-check"></i><b>4.4</b> Framebuffer</a>
<ul>
<li class="chapter" data-level="" data-path="framebuffer.html"><a href="framebuffer.html#screen-tearing"><i class="fa fa-check"></i>Screen tearing</a></li>
<li class="chapter" data-level="" data-path="framebuffer.html"><a href="framebuffer.html#vsync"><i class="fa fa-check"></i>Vsync</a></li>
<li class="chapter" data-level="" data-path="framebuffer.html"><a href="framebuffer.html#multiple-buffering"><i class="fa fa-check"></i>Multiple buffering</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="sierpinski.html"><a href="sierpinski.html"><i class="fa fa-check"></i><b>4.5</b> Triângulo de Sierpinski</a>
<ul>
<li class="chapter" data-level="" data-path="sierpinski.html"><a href="sierpinski.html#configuração-inicial-2"><i class="fa fa-check"></i>Configuração inicial</a></li>
<li class="chapter" data-level="" data-path="sierpinski.html"><a href="sierpinski.html#main.cpp-2"><i class="fa fa-check"></i>main.cpp</a></li>
<li class="chapter" data-level="" data-path="sierpinski.html"><a href="sierpinski.html#window.hpp-2"><i class="fa fa-check"></i>window.hpp</a></li>
<li class="chapter" data-level="" data-path="sierpinski.html"><a href="sierpinski.html#window.cpp-2"><i class="fa fa-check"></i>window.cpp</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="pipeline.html"><a href="pipeline.html"><i class="fa fa-check"></i><b>5</b> Pipeline gráfico</a>
<ul>
<li class="chapter" data-level="5.1" data-path="dados-gráficos.html"><a href="dados-gráficos.html"><i class="fa fa-check"></i><b>5.1</b> Dados gráficos</a></li>
<li class="chapter" data-level="5.2" data-path="ray-casting-x-rasterização.html"><a href="ray-casting-x-rasterização.html"><i class="fa fa-check"></i><b>5.2</b> Ray casting <em>x</em> rasterização</a>
<ul>
<li class="chapter" data-level="" data-path="ray-casting-x-rasterização.html"><a href="ray-casting-x-rasterização.html#ray-casting"><i class="fa fa-check"></i>Ray casting</a></li>
<li class="chapter" data-level="" data-path="ray-casting-x-rasterização.html"><a href="ray-casting-x-rasterização.html#rasterização"><i class="fa fa-check"></i>Rasterização</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="glpipeline.html"><a href="glpipeline.html"><i class="fa fa-check"></i><b>5.3</b> Pipeline do OpenGL</a>
<ul>
<li class="chapter" data-level="" data-path="glpipeline.html"><a href="glpipeline.html#aplicação"><i class="fa fa-check"></i>Aplicação</a></li>
<li class="chapter" data-level="" data-path="glpipeline.html"><a href="glpipeline.html#vertex-shader"><i class="fa fa-check"></i>Vertex shader</a></li>
<li class="chapter" data-level="" data-path="glpipeline.html"><a href="glpipeline.html#montagem-de-primitivas"><i class="fa fa-check"></i>Montagem de primitivas</a></li>
<li class="chapter" data-level="" data-path="glpipeline.html"><a href="glpipeline.html#recorte"><i class="fa fa-check"></i>Recorte</a></li>
<li class="chapter" data-level="" data-path="glpipeline.html"><a href="glpipeline.html#rasterização-1"><i class="fa fa-check"></i>Rasterização</a></li>
<li class="chapter" data-level="" data-path="glpipeline.html"><a href="glpipeline.html#fragment-shader"><i class="fa fa-check"></i>Fragment shader</a></li>
<li class="chapter" data-level="" data-path="glpipeline.html"><a href="glpipeline.html#operações-de-fragmentos"><i class="fa fa-check"></i>Operações de fragmentos</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="coloredtriangles.html"><a href="coloredtriangles.html"><i class="fa fa-check"></i><b>5.4</b> Triângulos coloridos</a>
<ul>
<li class="chapter" data-level="" data-path="coloredtriangles.html"><a href="coloredtriangles.html#configuração-inicial-3"><i class="fa fa-check"></i>Configuração inicial</a></li>
<li class="chapter" data-level="" data-path="coloredtriangles.html"><a href="coloredtriangles.html#main.cpp-3"><i class="fa fa-check"></i>main.cpp</a></li>
<li class="chapter" data-level="" data-path="coloredtriangles.html"><a href="coloredtriangles.html#window.hpp-3"><i class="fa fa-check"></i>window.hpp</a></li>
<li class="chapter" data-level="" data-path="coloredtriangles.html"><a href="coloredtriangles.html#window.cpp-3"><i class="fa fa-check"></i>window.cpp</a></li>
<li class="chapter" data-level="" data-path="coloredtriangles.html"><a href="coloredtriangles.html#ajustando-a-taxa-de-atualização"><i class="fa fa-check"></i>Ajustando a taxa de atualização</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="game.html"><a href="game.html"><i class="fa fa-check"></i><b>6</b> Desenvolvendo um jogo 2D</a>
<ul>
<li class="chapter" data-level="6.1" data-path="regularpolygons.html"><a href="regularpolygons.html"><i class="fa fa-check"></i><b>6.1</b> Polígonos regulares</a>
<ul>
<li class="chapter" data-level="" data-path="regularpolygons.html"><a href="regularpolygons.html#configuração-inicial-4"><i class="fa fa-check"></i>Configuração inicial</a></li>
<li class="chapter" data-level="" data-path="regularpolygons.html"><a href="regularpolygons.html#main.cpp-4"><i class="fa fa-check"></i>main.cpp</a></li>
<li class="chapter" data-level="" data-path="regularpolygons.html"><a href="regularpolygons.html#window.hpp-4"><i class="fa fa-check"></i>window.hpp</a></li>
<li class="chapter" data-level="" data-path="regularpolygons.html"><a href="regularpolygons.html#window.cpp-4"><i class="fa fa-check"></i>window.cpp</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="asteroids.html"><a href="asteroids.html"><i class="fa fa-check"></i><b>6.2</b> Asteroids</a>
<ul>
<li class="chapter" data-level="" data-path="asteroids.html"><a href="asteroids.html#organização-do-projeto"><i class="fa fa-check"></i>Organização do projeto</a></li>
<li class="chapter" data-level="" data-path="asteroids.html"><a href="asteroids.html#configuração-inicial-5"><i class="fa fa-check"></i>Configuração inicial</a></li>
<li class="chapter" data-level="" data-path="asteroids.html"><a href="asteroids.html#nave"><i class="fa fa-check"></i>Nave</a></li>
<li class="chapter" data-level="" data-path="asteroids.html"><a href="asteroids.html#estrelas"><i class="fa fa-check"></i>Estrelas</a></li>
<li class="chapter" data-level="" data-path="asteroids.html"><a href="asteroids.html#asteroides"><i class="fa fa-check"></i>Asteroides</a></li>
<li class="chapter" data-level="" data-path="asteroids.html"><a href="asteroids.html#tiros-e-colisões"><i class="fa fa-check"></i>Tiros e colisões</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="geometry.html"><a href="geometry.html"><i class="fa fa-check"></i><b>7</b> Espaços e geometria</a>
<ul>
<li class="chapter" data-level="7.1" data-path="vector.html"><a href="vector.html"><i class="fa fa-check"></i><b>7.1</b> Espaço vetorial</a>
<ul>
<li class="chapter" data-level="" data-path="vector.html"><a href="vector.html#combinação-e-independência-linear"><i class="fa fa-check"></i>Combinação e independência linear</a></li>
<li class="chapter" data-level="" data-path="vector.html"><a href="vector.html#dimensão-e-base"><i class="fa fa-check"></i>Dimensão e base</a></li>
<li class="chapter" data-level="" data-path="vector.html"><a href="vector.html#vetores-geométricos"><i class="fa fa-check"></i>Vetores geométricos</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="affine.html"><a href="affine.html"><i class="fa fa-check"></i><b>7.2</b> Espaço afim</a>
<ul>
<li class="chapter" data-level="" data-path="affine.html"><a href="affine.html#combinação-afim"><i class="fa fa-check"></i>Combinação afim</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="euclidean.html"><a href="euclidean.html"><i class="fa fa-check"></i><b>7.3</b> Espaço euclidiano</a>
<ul>
<li class="chapter" data-level="" data-path="euclidean.html"><a href="euclidean.html#quadro-de-referência"><i class="fa fa-check"></i>Quadro de referência</a></li>
<li class="chapter" data-level="" data-path="euclidean.html"><a href="euclidean.html#produto-escalar"><i class="fa fa-check"></i>Produto escalar</a></li>
<li class="chapter" data-level="" data-path="euclidean.html"><a href="euclidean.html#ortogonalidade"><i class="fa fa-check"></i>Ortogonalidade</a></li>
<li class="chapter" data-level="" data-path="euclidean.html"><a href="euclidean.html#comprimento-e-distância"><i class="fa fa-check"></i>Comprimento e distância</a></li>
<li class="chapter" data-level="" data-path="euclidean.html"><a href="euclidean.html#normalização"><i class="fa fa-check"></i>Normalização</a></li>
<li class="chapter" data-level="" data-path="euclidean.html"><a href="euclidean.html#ângulo-entre-vetores"><i class="fa fa-check"></i>Ângulo entre vetores</a></li>
<li class="chapter" data-level="" data-path="euclidean.html"><a href="euclidean.html#projeção-ortogonal"><i class="fa fa-check"></i>Projeção ortogonal</a></li>
<li class="chapter" data-level="" data-path="euclidean.html"><a href="euclidean.html#produto-vetorial"><i class="fa fa-check"></i>Produto vetorial</a></li>
<li class="chapter" data-level="" data-path="euclidean.html"><a href="euclidean.html#vetor-normal"><i class="fa fa-check"></i>Vetor normal</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="objmodel.html"><a href="objmodel.html"><i class="fa fa-check"></i><b>7.4</b> Lendo um modelo 3D</a>
<ul>
<li class="chapter" data-level="" data-path="objmodel.html"><a href="objmodel.html#orientação-e-face-culling"><i class="fa fa-check"></i>Orientação e face culling</a></li>
<li class="chapter" data-level="" data-path="objmodel.html"><a href="objmodel.html#configuração-inicial-6"><i class="fa fa-check"></i>Configuração inicial</a></li>
<li class="chapter" data-level="" data-path="objmodel.html"><a href="objmodel.html#main.cpp-6"><i class="fa fa-check"></i>main.cpp</a></li>
<li class="chapter" data-level="" data-path="objmodel.html"><a href="objmodel.html#loadmodel.vert"><i class="fa fa-check"></i>loadmodel.vert</a></li>
<li class="chapter" data-level="" data-path="objmodel.html"><a href="objmodel.html#loadmodel.frag"><i class="fa fa-check"></i>loadmodel.frag</a></li>
<li class="chapter" data-level="" data-path="objmodel.html"><a href="objmodel.html#window.hpp-6"><i class="fa fa-check"></i>window.hpp</a></li>
<li class="chapter" data-level="" data-path="objmodel.html"><a href="objmodel.html#window.cpp-6"><i class="fa fa-check"></i>window.cpp</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="transformations.html"><a href="transformations.html"><i class="fa fa-check"></i><b>8</b> Matrizes e transformações</a>
<ul>
<li class="chapter" data-level="8.1" data-path="matrix.html"><a href="matrix.html"><i class="fa fa-check"></i><b>8.1</b> Matrizes</a>
<ul>
<li class="chapter" data-level="" data-path="matrix.html"><a href="matrix.html#matriz-transposta"><i class="fa fa-check"></i>Matriz transposta</a></li>
<li class="chapter" data-level="" data-path="matrix.html"><a href="matrix.html#matriz-quadrada"><i class="fa fa-check"></i>Matriz quadrada</a></li>
<li class="chapter" data-level="" data-path="matrix.html"><a href="matrix.html#matriz-linhacoluna"><i class="fa fa-check"></i>Matriz linha/coluna</a></li>
<li class="chapter" data-level="" data-path="matrix.html"><a href="matrix.html#matriz-identidade"><i class="fa fa-check"></i>Matriz identidade</a></li>
<li class="chapter" data-level="" data-path="matrix.html"><a href="matrix.html#operações"><i class="fa fa-check"></i>Operações</a></li>
<li class="chapter" data-level="" data-path="matrix.html"><a href="matrix.html#matriz-inversa"><i class="fa fa-check"></i>Matriz inversa</a></li>
<li class="chapter" data-level="" data-path="matrix.html"><a href="matrix.html#matriz-ortogonal"><i class="fa fa-check"></i>Matriz ortogonal</a></li>
<li class="chapter" data-level="" data-path="matrix.html"><a href="matrix.html#propriedades"><i class="fa fa-check"></i>Propriedades</a></li>
<li class="chapter" data-level="" data-path="matrix.html"><a href="matrix.html#transformação-linear"><i class="fa fa-check"></i>Transformação linear</a></li>
<li class="chapter" data-level="" data-path="matrix.html"><a href="matrix.html#mudança-de-base"><i class="fa fa-check"></i>Mudança de base</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="homogeneous.html"><a href="homogeneous.html"><i class="fa fa-check"></i><b>8.2</b> Coordenadas homogêneas</a></li>
<li class="chapter" data-level="8.3" data-path="concat.html"><a href="concat.html"><i class="fa fa-check"></i><b>8.3</b> Concatenação de transformações</a></li>
<li class="chapter" data-level="8.4" data-path="transforms.html"><a href="transforms.html"><i class="fa fa-check"></i><b>8.4</b> Transformações</a>
<ul>
<li class="chapter" data-level="" data-path="transforms.html"><a href="transforms.html#identidade"><i class="fa fa-check"></i>Identidade</a></li>
<li class="chapter" data-level="" data-path="transforms.html"><a href="transforms.html#translação"><i class="fa fa-check"></i>Translação</a></li>
<li class="chapter" data-level="" data-path="transforms.html"><a href="transforms.html#escala"><i class="fa fa-check"></i>Escala</a></li>
<li class="chapter" data-level="" data-path="transforms.html"><a href="transforms.html#rotação"><i class="fa fa-check"></i>Rotação</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="glspaces.html"><a href="glspaces.html"><i class="fa fa-check"></i><b>8.5</b> Espaços do OpenGL</a>
<ul>
<li class="chapter" data-level="" data-path="glspaces.html"><a href="glspaces.html#espaço-do-objeto"><i class="fa fa-check"></i>Espaço do objeto</a></li>
<li class="chapter" data-level="" data-path="glspaces.html"><a href="glspaces.html#espaço-do-mundo"><i class="fa fa-check"></i>Espaço do mundo</a></li>
<li class="chapter" data-level="" data-path="glspaces.html"><a href="glspaces.html#espaço-da-câmera"><i class="fa fa-check"></i>Espaço da câmera</a></li>
<li class="chapter" data-level="" data-path="glspaces.html"><a href="glspaces.html#concatenação-das-matrizes-de-modelo-e-visão"><i class="fa fa-check"></i>Concatenação das matrizes de modelo e visão</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="lookat.html"><a href="lookat.html"><i class="fa fa-check"></i><b>8.6</b> Câmera LookAt</a>
<ul>
<li class="chapter" data-level="" data-path="lookat.html"><a href="lookat.html#construindo-o-vetor-n"><i class="fa fa-check"></i>Construindo o vetor n</a></li>
<li class="chapter" data-level="" data-path="lookat.html"><a href="lookat.html#construindo-o-vetor-u"><i class="fa fa-check"></i>Construindo o vetor u</a></li>
<li class="chapter" data-level="" data-path="lookat.html"><a href="lookat.html#construindo-o-vetor-v"><i class="fa fa-check"></i>Construindo o vetor v</a></li>
<li class="chapter" data-level="" data-path="lookat.html"><a href="lookat.html#construindo-a-matriz-de-visão"><i class="fa fa-check"></i>Construindo a matriz de visão</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="lookatproject.html"><a href="lookatproject.html"><i class="fa fa-check"></i><b>8.7</b> LookAt na prática</a>
<ul>
<li class="chapter" data-level="" data-path="lookatproject.html"><a href="lookatproject.html#configuração-inicial-7"><i class="fa fa-check"></i>Configuração inicial</a></li>
<li class="chapter" data-level="" data-path="lookatproject.html"><a href="lookatproject.html#main.cpp-7"><i class="fa fa-check"></i>main.cpp</a></li>
<li class="chapter" data-level="" data-path="lookatproject.html"><a href="lookatproject.html#lookat.vert"><i class="fa fa-check"></i>lookat.vert</a></li>
<li class="chapter" data-level="" data-path="lookatproject.html"><a href="lookatproject.html#lookat.frag"><i class="fa fa-check"></i>lookat.frag</a></li>
<li class="chapter" data-level="" data-path="lookatproject.html"><a href="lookatproject.html#camera.hpp"><i class="fa fa-check"></i>camera.hpp</a></li>
<li class="chapter" data-level="" data-path="lookatproject.html"><a href="lookatproject.html#camera.cpp"><i class="fa fa-check"></i>camera.cpp</a></li>
<li class="chapter" data-level="" data-path="lookatproject.html"><a href="lookatproject.html#window.hpp-7"><i class="fa fa-check"></i>window.hpp</a></li>
<li class="chapter" data-level="" data-path="lookatproject.html"><a href="lookatproject.html#window.cpp-7"><i class="fa fa-check"></i>window.cpp</a></li>
<li class="chapter" data-level="" data-path="lookatproject.html"><a href="lookatproject.html#ground.hpp"><i class="fa fa-check"></i>ground.hpp</a></li>
<li class="chapter" data-level="" data-path="lookatproject.html"><a href="lookatproject.html#ground.cpp"><i class="fa fa-check"></i>ground.cpp</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="projections.html"><a href="projections.html"><i class="fa fa-check"></i><b>9</b> Projeções e trackball virtual</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ortho.html"><a href="ortho.html"><i class="fa fa-check"></i><b>9.1</b> Projeção ortográfica</a>
<ul>
<li class="chapter" data-level="" data-path="ortho.html"><a href="ortho.html#translação-1"><i class="fa fa-check"></i>Translação</a></li>
<li class="chapter" data-level="" data-path="ortho.html"><a href="ortho.html#escala-e-reflexão"><i class="fa fa-check"></i>Escala e reflexão</a></li>
<li class="chapter" data-level="" data-path="ortho.html"><a href="ortho.html#matriz-de-projeção"><i class="fa fa-check"></i>Matriz de projeção</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="perspective.html"><a href="perspective.html"><i class="fa fa-check"></i><b>9.2</b> Projeção perspectiva</a>
<ul>
<li class="chapter" data-level="" data-path="perspective.html"><a href="perspective.html#matriz-de-projeção-1"><i class="fa fa-check"></i>Matriz de projeção</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="vtrackball1.html"><a href="vtrackball1.html"><i class="fa fa-check"></i><b>9.3</b> Trackball virtual</a>
<ul>
<li class="chapter" data-level="" data-path="vtrackball1.html"><a href="vtrackball1.html#rotação-em-torno-de-um-eixo-arbitrário"><i class="fa fa-check"></i>Rotação em torno de um eixo arbitrário</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="viewer1.html"><a href="viewer1.html"><i class="fa fa-check"></i><b>9.4</b> Visualizador 3D</a>
<ul>
<li class="chapter" data-level="" data-path="viewer1.html"><a href="viewer1.html#configuração-inicial-8"><i class="fa fa-check"></i>Configuração inicial</a></li>
<li class="chapter" data-level="" data-path="viewer1.html"><a href="viewer1.html#main.cpp-8"><i class="fa fa-check"></i>main.cpp</a></li>
<li class="chapter" data-level="" data-path="viewer1.html"><a href="viewer1.html#depth.vert"><i class="fa fa-check"></i>depth.vert</a></li>
<li class="chapter" data-level="" data-path="viewer1.html"><a href="viewer1.html#depth.frag"><i class="fa fa-check"></i>depth.frag</a></li>
<li class="chapter" data-level="" data-path="viewer1.html"><a href="viewer1.html#model.hpp"><i class="fa fa-check"></i>model.hpp</a></li>
<li class="chapter" data-level="" data-path="viewer1.html"><a href="viewer1.html#model.cpp"><i class="fa fa-check"></i>model.cpp</a></li>
<li class="chapter" data-level="" data-path="viewer1.html"><a href="viewer1.html#trackball.hpp"><i class="fa fa-check"></i>trackball.hpp</a></li>
<li class="chapter" data-level="" data-path="viewer1.html"><a href="viewer1.html#trackball.cpp"><i class="fa fa-check"></i>trackball.cpp</a></li>
<li class="chapter" data-level="" data-path="viewer1.html"><a href="viewer1.html#openglwindow.hpp"><i class="fa fa-check"></i>openglwindow.hpp</a></li>
<li class="chapter" data-level="" data-path="viewer1.html"><a href="viewer1.html#openglwindow.cpp"><i class="fa fa-check"></i>openglwindow.cpp</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="starfield.html"><a href="starfield.html"><i class="fa fa-check"></i><b>9.5</b> Efeito starfield</a>
<ul>
<li class="chapter" data-level="" data-path="starfield.html"><a href="starfield.html#configuração-inicial-9"><i class="fa fa-check"></i>Configuração inicial</a></li>
<li class="chapter" data-level="" data-path="starfield.html"><a href="starfield.html#main.cpp-9"><i class="fa fa-check"></i>main.cpp</a></li>
<li class="chapter" data-level="" data-path="starfield.html"><a href="starfield.html#depth.vert-1"><i class="fa fa-check"></i>depth.vert</a></li>
<li class="chapter" data-level="" data-path="starfield.html"><a href="starfield.html#depth.frag-1"><i class="fa fa-check"></i>depth.frag</a></li>
<li class="chapter" data-level="" data-path="starfield.html"><a href="starfield.html#openglwindow.hpp-1"><i class="fa fa-check"></i>openglwindow.hpp</a></li>
<li class="chapter" data-level="" data-path="starfield.html"><a href="starfield.html#openglwindow.cpp-1"><i class="fa fa-check"></i>openglwindow.cpp</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="referências.html"><a href="referências.html"><i class="fa fa-check"></i>Referências</a></li>
<li class="divider"></li>
<li>
<a href="https://github.com/hbatagelo/abcg" target="blank">ABCg no GitHub</a>
<br>
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MCTA008-17 Computação Gráfica</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="starfield" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Efeito starfield<a href="starfield.html#starfield" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nesta seção aplicaremos a transformação de projeção perspectiva para produzir um interessante efeito de “campo estelar” (starfield) formado por cubos giratórios.</p>
<p>A aplicação permitirá alterar o ângulo de abertura do campo de visão, bem como alternar entre projeção perspectiva e projeção ortográfica.</p>
<p>O resultado ficará como a seguir.</p>
<iframe
  src="https://hbatagelo.github.io/abcgapps/starfield/index.html"
  allow="gamepad" frameborder="0" allowfullscreen="true" allowtransparency="true" emscriptenheight="740"
  ></iframe>
<p>Veja como o uso de projeção perspectiva é essencial para produzir o efeito desejado (compare com a projeção ortográfica).</p>
<div id="configuração-inicial-9" class="section level3 unnumbered hasAnchor">
<h3>Configuração inicial<a href="starfield.html#configuração-inicial-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>No arquivo <code>abcg/examples/CMakeLists.txt</code>, inclua a linha:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode cmake"><code class="sourceCode cmake"><span id="cb22-1"><a href="starfield.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">add_subdirectory</span>(starfield)</span></code></pre></div></li>
<li><p>Crie o subdiretório <code>abcg/examples/starfield</code> e o arquivo <code>abcg/examples/starfield/CMakeLists.txt</code> com o seguinte conteúdo:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode cmake"><code class="sourceCode cmake"><span id="cb23-1"><a href="starfield.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">project</span>(starfield)</span>
<span id="cb23-2"><a href="starfield.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="kw">add_executable</span>(<span class="dv">${PROJECT_NAME}</span> <span class="bn">main.cpp</span> model.cpp openglwindow.cpp)</span>
<span id="cb23-3"><a href="starfield.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">enable_abcg</span>(<span class="dv">${PROJECT_NAME}</span>)</span></code></pre></div></li>
<li><p>Crie os seguintes arquivos vazios:</p>
<ul>
<li><code>main.cpp</code>;</li>
<li><code>openglwindow.cpp</code> e <code>openglwindow.hpp</code>.</li>
<li><code>trackball.cpp</code> e <code>trackball.hpp</code>.</li>
</ul></li>
<li><p>Copie os arquivos <code>model.cpp</code> e <code>model.hpp</code> do projeto da seção anterior (seção <a href="viewer1.html#viewer1">9.4</a>), pois eles serão utilizados sem modificações.</p></li>
<li><p>Crie o subdiretório <code>abcg/examples/starfield/assets</code> e, dentro dele, crie os arquivos vazios <code>depth.frag</code> e <code>depth.vert</code>. Além disso, copie para este subdiretório o modelo <code>box.obj</code> disponível <a href="https://hbatagelo.github.io/abcgapps/data/objmodels.zip">neste link</a>.</p></li>
</ul>
<p>A estrutura de <code>abcg/examples/starfield</code> ficará assim:</p>
<pre><code>starfield/
│   CMakeLists.txt
│   main.cpp
│   model.hpp
│   model.cpp
│   openglwindow.hpp
│   openglwindow.cpp
│
└───assets/
    │   box.obj
    │   depth.frag    
    └   depth.vert</code></pre>
</div>
<div id="main.cpp-9" class="section level3 unnumbered hasAnchor">
<h3>main.cpp<a href="starfield.html#main.cpp-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>O conteúdo é igual ao do projeto anterior. Só mudamos o título da janela:</p>
<div class="sourceCode" id="cb25" startFrom="1"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp"><span id="cb25-1"><a href="starfield.html#cb25-1"></a><span class="pp">#include </span><span class="im">&lt;fmt/core.h&gt;</span></span>
<span id="cb25-2"><a href="starfield.html#cb25-2"></a></span>
<span id="cb25-3"><a href="starfield.html#cb25-3"></a><span class="pp">#include </span><span class="im">&quot;abcg.hpp&quot;</span></span>
<span id="cb25-4"><a href="starfield.html#cb25-4"></a><span class="pp">#include </span><span class="im">&quot;openglwindow.hpp&quot;</span></span>
<span id="cb25-5"><a href="starfield.html#cb25-5"></a></span>
<span id="cb25-6"><a href="starfield.html#cb25-6"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">int</span> argc<span class="op">,</span> <span class="dt">char</span> <span class="op">**</span>argv<span class="op">)</span> <span class="op">{</span></span>
<span id="cb25-7"><a href="starfield.html#cb25-7"></a>  <span class="cf">try</span> <span class="op">{</span></span>
<span id="cb25-8"><a href="starfield.html#cb25-8"></a>    abcg<span class="op">::</span>Application app<span class="op">(</span>argc<span class="op">,</span> argv<span class="op">);</span></span>
<span id="cb25-9"><a href="starfield.html#cb25-9"></a></span>
<span id="cb25-10"><a href="starfield.html#cb25-10"></a>    <span class="kw">auto</span> window<span class="op">{</span><span class="bu">std::</span>make_unique<span class="op">&lt;</span>OpenGLWindow<span class="op">&gt;()};</span></span>
<span id="cb25-11"><a href="starfield.html#cb25-11"></a>    window<span class="op">-&gt;</span>setOpenGLSettings<span class="op">({.</span>samples <span class="op">=</span> <span class="dv">4</span><span class="op">});</span></span>
<span id="cb25-12"><a href="starfield.html#cb25-12"></a>    window<span class="op">-&gt;</span>setWindowSettings<span class="op">(</span></span>
<span id="cb25-13"><a href="starfield.html#cb25-13"></a>        <span class="op">{.</span>width <span class="op">=</span> <span class="dv">600</span><span class="op">,</span> <span class="op">.</span>height <span class="op">=</span> <span class="dv">600</span><span class="op">,</span> <span class="op">.</span>title <span class="op">=</span> <span class="st">&quot;Starfield Effect&quot;</span><span class="op">});</span></span>
<span id="cb25-14"><a href="starfield.html#cb25-14"></a></span>
<span id="cb25-15"><a href="starfield.html#cb25-15"></a>    app<span class="op">.</span>run<span class="op">(</span><span class="bu">std::</span>move<span class="op">(</span>window<span class="op">));</span></span>
<span id="cb25-16"><a href="starfield.html#cb25-16"></a>  <span class="op">}</span> <span class="cf">catch</span> <span class="op">(</span><span class="at">const</span> abcg<span class="op">::</span>Exception <span class="op">&amp;</span>exception<span class="op">)</span> <span class="op">{</span></span>
<span id="cb25-17"><a href="starfield.html#cb25-17"></a>    fmt<span class="op">::</span>print<span class="op">(</span>stderr<span class="op">,</span> <span class="st">&quot;</span><span class="sc">{}\n</span><span class="st">&quot;</span><span class="op">,</span> exception<span class="op">.</span>what<span class="op">());</span></span>
<span id="cb25-18"><a href="starfield.html#cb25-18"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb25-19"><a href="starfield.html#cb25-19"></a>  <span class="op">}</span></span>
<span id="cb25-20"><a href="starfield.html#cb25-20"></a>  <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb25-21"><a href="starfield.html#cb25-21"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="depth.vert-1" class="section level3 unnumbered hasAnchor">
<h3>depth.vert<a href="starfield.html#depth.vert-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>O vertex shader também é igual ao do projeto anterior. Só precisamos alterar <code>-posEyeSpace.z / 3.0</code> para <code>-posEyeSpace.z / 100.0</code> para que a intensidade da cor seja zero apenas quando <span class="math inline">\(z&lt;-100\)</span> no espaço da câmera.</p>
<div class="sourceCode" id="cb26" startFrom="1"><pre class="sourceCode numberSource glsl numberLines"><code class="sourceCode glsl"><span id="cb26-1"><a href="starfield.html#cb26-1"></a><span class="pp">#version 410</span></span>
<span id="cb26-2"><a href="starfield.html#cb26-2"></a></span>
<span id="cb26-3"><a href="starfield.html#cb26-3"></a><span class="kw">layout</span><span class="op">(</span><span class="dt">location</span> <span class="op">=</span> <span class="dv">0</span><span class="op">)</span> <span class="dt">in</span> <span class="dt">vec3</span> inPosition<span class="op">;</span></span>
<span id="cb26-4"><a href="starfield.html#cb26-4"></a></span>
<span id="cb26-5"><a href="starfield.html#cb26-5"></a><span class="kw">uniform</span> <span class="dt">vec4</span> color<span class="op">;</span></span>
<span id="cb26-6"><a href="starfield.html#cb26-6"></a><span class="kw">uniform</span> <span class="dt">mat4</span> modelMatrix<span class="op">;</span></span>
<span id="cb26-7"><a href="starfield.html#cb26-7"></a><span class="kw">uniform</span> <span class="dt">mat4</span> viewMatrix<span class="op">;</span></span>
<span id="cb26-8"><a href="starfield.html#cb26-8"></a><span class="kw">uniform</span> <span class="dt">mat4</span> projMatrix<span class="op">;</span></span>
<span id="cb26-9"><a href="starfield.html#cb26-9"></a></span>
<span id="cb26-10"><a href="starfield.html#cb26-10"></a><span class="dt">out</span> <span class="dt">vec4</span> fragColor<span class="op">;</span></span>
<span id="cb26-11"><a href="starfield.html#cb26-11"></a></span>
<span id="cb26-12"><a href="starfield.html#cb26-12"></a><span class="dt">void</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb26-13"><a href="starfield.html#cb26-13"></a>  <span class="dt">vec4</span> posEyeSpace <span class="op">=</span> viewMatrix <span class="op">*</span> modelMatrix <span class="op">*</span> <span class="dt">vec4</span><span class="op">(</span>inPosition<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb26-14"><a href="starfield.html#cb26-14"></a></span>
<span id="cb26-15"><a href="starfield.html#cb26-15"></a>  <span class="dt">float</span> i <span class="op">=</span> <span class="fl">1.0</span> <span class="op">-</span> <span class="op">(-</span>posEyeSpace<span class="op">.</span><span class="fu">z</span> <span class="op">/</span> <span class="fl">100.0</span><span class="op">);</span></span>
<span id="cb26-16"><a href="starfield.html#cb26-16"></a>  fragColor <span class="op">=</span> <span class="dt">vec4</span><span class="op">(</span>i<span class="op">,</span> i<span class="op">,</span> i<span class="op">,</span> <span class="dv">1</span><span class="op">)</span> <span class="op">*</span> color<span class="op">;</span></span>
<span id="cb26-17"><a href="starfield.html#cb26-17"></a></span>
<span id="cb26-18"><a href="starfield.html#cb26-18"></a>  <span class="bu">gl_Position</span> <span class="op">=</span> projMatrix <span class="op">*</span> posEyeSpace<span class="op">;</span></span>
<span id="cb26-19"><a href="starfield.html#cb26-19"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="depth.frag-1" class="section level3 unnumbered hasAnchor">
<h3>depth.frag<a href="starfield.html#depth.frag-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>O conteúdo do fragment shader é mais simples que o <code>depth.frag</code> do projeto anterior. A cor recebida no atributo de entrada (<code>fragColor</code>) é enviada sem modificações para o atributo de saída (<code>outColor</code>):</p>
<div class="sourceCode" id="cb27" startFrom="1"><pre class="sourceCode numberSource glsl numberLines"><code class="sourceCode glsl"><span id="cb27-1"><a href="starfield.html#cb27-1"></a><span class="pp">#version 410</span></span>
<span id="cb27-2"><a href="starfield.html#cb27-2"></a></span>
<span id="cb27-3"><a href="starfield.html#cb27-3"></a><span class="dt">in</span> <span class="dt">vec4</span> fragColor<span class="op">;</span></span>
<span id="cb27-4"><a href="starfield.html#cb27-4"></a><span class="dt">out</span> <span class="dt">vec4</span> outColor<span class="op">;</span></span>
<span id="cb27-5"><a href="starfield.html#cb27-5"></a></span>
<span id="cb27-6"><a href="starfield.html#cb27-6"></a><span class="dt">void</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span> outColor <span class="op">=</span> fragColor<span class="op">;</span> <span class="op">}</span></span></code></pre></div>
</div>
<div id="openglwindow.hpp-1" class="section level3 unnumbered hasAnchor">
<h3>openglwindow.hpp<a href="starfield.html#openglwindow.hpp-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A definição da classe <code>OpenGLWindow</code> ficará assim:</p>
<div class="sourceCode" id="cb28" startFrom="1"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp"><span id="cb28-1"><a href="starfield.html#cb28-1"></a><span class="pp">#ifndef OPENGLWINDOW_HPP_</span></span>
<span id="cb28-2"><a href="starfield.html#cb28-2"></a><span class="pp">#define OPENGLWINDOW_HPP_</span></span>
<span id="cb28-3"><a href="starfield.html#cb28-3"></a></span>
<span id="cb28-4"><a href="starfield.html#cb28-4"></a><span class="pp">#include </span><span class="im">&lt;random&gt;</span></span>
<span id="cb28-5"><a href="starfield.html#cb28-5"></a></span>
<span id="cb28-6"><a href="starfield.html#cb28-6"></a><span class="pp">#include </span><span class="im">&quot;abcg.hpp&quot;</span></span>
<span id="cb28-7"><a href="starfield.html#cb28-7"></a><span class="pp">#include </span><span class="im">&quot;model.hpp&quot;</span></span>
<span id="cb28-8"><a href="starfield.html#cb28-8"></a></span>
<span id="cb28-9"><a href="starfield.html#cb28-9"></a><span class="kw">class</span> OpenGLWindow <span class="op">:</span> <span class="kw">public</span> abcg<span class="op">::</span>OpenGLWindow <span class="op">{</span></span>
<span id="cb28-10"><a href="starfield.html#cb28-10"></a> <span class="kw">protected</span><span class="op">:</span></span>
<span id="cb28-11"><a href="starfield.html#cb28-11"></a>  <span class="dt">void</span> initializeGL<span class="op">()</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb28-12"><a href="starfield.html#cb28-12"></a>  <span class="dt">void</span> paintGL<span class="op">()</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb28-13"><a href="starfield.html#cb28-13"></a>  <span class="dt">void</span> paintUI<span class="op">()</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb28-14"><a href="starfield.html#cb28-14"></a>  <span class="dt">void</span> resizeGL<span class="op">(</span><span class="dt">int</span> width<span class="op">,</span> <span class="dt">int</span> height<span class="op">)</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb28-15"><a href="starfield.html#cb28-15"></a>  <span class="dt">void</span> terminateGL<span class="op">()</span> <span class="kw">override</span><span class="op">;</span></span>
<span id="cb28-16"><a href="starfield.html#cb28-16"></a></span>
<span id="cb28-17"><a href="starfield.html#cb28-17"></a> <span class="kw">private</span><span class="op">:</span></span>
<span id="cb28-18"><a href="starfield.html#cb28-18"></a>  <span class="at">static</span> <span class="at">const</span> <span class="dt">int</span> <span class="va">m_numStars</span><span class="op">{</span><span class="dv">500</span><span class="op">};</span></span>
<span id="cb28-19"><a href="starfield.html#cb28-19"></a></span>
<span id="cb28-20"><a href="starfield.html#cb28-20"></a>  GLuint <span class="va">m_program</span><span class="op">{};</span></span>
<span id="cb28-21"><a href="starfield.html#cb28-21"></a></span>
<span id="cb28-22"><a href="starfield.html#cb28-22"></a>  <span class="dt">int</span> <span class="va">m_viewportWidth</span><span class="op">{};</span></span>
<span id="cb28-23"><a href="starfield.html#cb28-23"></a>  <span class="dt">int</span> <span class="va">m_viewportHeight</span><span class="op">{};</span></span>
<span id="cb28-24"><a href="starfield.html#cb28-24"></a></span>
<span id="cb28-25"><a href="starfield.html#cb28-25"></a>  <span class="bu">std::</span>default_random_engine<span class="op"> </span><span class="va">m_randomEngine</span><span class="op">;</span></span>
<span id="cb28-26"><a href="starfield.html#cb28-26"></a></span>
<span id="cb28-27"><a href="starfield.html#cb28-27"></a>  Model <span class="va">m_model</span><span class="op">;</span></span>
<span id="cb28-28"><a href="starfield.html#cb28-28"></a></span>
<span id="cb28-29"><a href="starfield.html#cb28-29"></a>  <span class="bu">std::</span>array<span class="op">&lt;</span>glm<span class="op">::</span>vec3<span class="op">,</span> <span class="va">m_numStars</span><span class="op">&gt;</span> <span class="va">m_starPositions</span><span class="op">;</span></span>
<span id="cb28-30"><a href="starfield.html#cb28-30"></a>  <span class="bu">std::</span>array<span class="op">&lt;</span>glm<span class="op">::</span>vec3<span class="op">,</span> <span class="va">m_numStars</span><span class="op">&gt;</span> <span class="va">m_starRotations</span><span class="op">;</span></span>
<span id="cb28-31"><a href="starfield.html#cb28-31"></a>  <span class="dt">float</span> <span class="va">m_angle</span><span class="op">{};</span></span>
<span id="cb28-32"><a href="starfield.html#cb28-32"></a></span>
<span id="cb28-33"><a href="starfield.html#cb28-33"></a>  glm<span class="op">::</span>mat4 <span class="va">m_viewMatrix</span><span class="op">{</span><span class="fl">1.0</span><span class="bu">f</span><span class="op">};</span></span>
<span id="cb28-34"><a href="starfield.html#cb28-34"></a>  glm<span class="op">::</span>mat4 <span class="va">m_projMatrix</span><span class="op">{</span><span class="fl">1.0</span><span class="bu">f</span><span class="op">};</span></span>
<span id="cb28-35"><a href="starfield.html#cb28-35"></a>  <span class="dt">float</span> <span class="va">m_FOV</span><span class="op">{</span><span class="fl">30.0</span><span class="bu">f</span><span class="op">};</span></span>
<span id="cb28-36"><a href="starfield.html#cb28-36"></a></span>
<span id="cb28-37"><a href="starfield.html#cb28-37"></a>  <span class="dt">void</span> randomizeStar<span class="op">(</span>glm<span class="op">::</span>vec3 <span class="op">&amp;</span>position<span class="op">,</span> glm<span class="op">::</span>vec3 <span class="op">&amp;</span>rotation<span class="op">);</span></span>
<span id="cb28-38"><a href="starfield.html#cb28-38"></a>  <span class="dt">void</span> update<span class="op">();</span></span>
<span id="cb28-39"><a href="starfield.html#cb28-39"></a><span class="op">};</span></span>
<span id="cb28-40"><a href="starfield.html#cb28-40"></a></span>
<span id="cb28-41"><a href="starfield.html#cb28-41"></a><span class="pp">#endif</span></span></code></pre></div>
<p>O objeto <code>m_model</code>, definido na linha 27, é utilizado para armazenar o VBO/EBO e VAO que representa a estrela do campo estrelado. No nosso caso, a estrela será um cubo centralizado na origem, definido pelo arquivo <code>box.obj</code>. A cena 3D será formada por 500 instâncias do cubo. Esse número é definido pela constante <code>m_numStars</code> na linha 18.</p>
<p>Nas linhas 29 e 30 são definidos arranjos de 500 posições aleatórias (<code>m_starPositions</code>) e 500 eixos aleatórios de rotação (<code>m_starRotations</code>), um para cada cubo da cena. Através desses atributos podemos criar uma matriz de modelo para cada cubo. Cada matriz de modelo será definida como uma concatenação</p>
<p><span class="math display">\[
\mathbf{M}_{\textrm{model}}=\mathbf{T}\mathbf{S}\mathbf{R},
\]</span></p>
<p>onde <span class="math inline">\(\mathbf{R}\)</span> é uma rotação que faz o cubo centralizado na origem girar em torno de um eixo especificado em <code>m_starRotations</code>, <span class="math inline">\(\mathbf{S}\)</span> é um fator de escala uniforme (usaremos <span class="math inline">\(s=0.2\)</span> para todos os cubos) e <span class="math inline">\(\mathbf{T}\)</span> é a translação que faz com que o cubo rotacionado seja posicionado no espaço do mundo na posição indicada em <code>m_starPositions</code>.</p>
<p>Na linha 31, <code>m_angle</code> é um ângulo de rotação em radianos que será utilizado para rodar cada cubo por seu respectivo eixo de rotação (os cubos rodam pelo mesmo ângulo, mas cada um tem seu próprio eixo aleatório de rotação).</p>
<p>Nas linhas 33 e 34 são definidas as matrizes de visão (<code>m_viewMatrix</code>) e de projeção (<code>m_projMatrix</code>). Aqui elas estão como matrizes identidade, mas serão definidas posteriormente em <code>OpenGLWindow::initializeGL</code> e <code>OpenGLWindow::paintUI</code>.</p>
<p>Na linha 35, o atributo <code>m_FOV</code> é o ângulo de abertura vertical do campo de visão da projeção perspectiva. Esse valor poderá ser controlado por um slider da ImGui, variando de <span class="math inline">\(5^\circ\)</span> a <span class="math inline">\(179^\circ\)</span>.</p>
<p>A função <code>OpenGLWindow::randomizeStar</code> (linha 37) usa o gerador de números pseudoaleatórios <code>m_randomEngine</code> (linha 25) para sortear uma posição e eixo de rotação. O resultado é armazenado nos parâmetros <code>position</code> e <code>rotation</code> passados por referência.</p>
</div>
<div id="openglwindow.cpp-1" class="section level3 unnumbered hasAnchor">
<h3>openglwindow.cpp<a href="starfield.html#openglwindow.cpp-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>O arquivo <code>openglwindow.cpp</code> começa com a definição de <code>OpenGLWindow::initializeGL</code>:</p>
<div class="sourceCode" id="cb29" startFrom="1"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp"><span id="cb29-1"><a href="starfield.html#cb29-1"></a><span class="pp">#include </span><span class="im">&quot;openglwindow.hpp&quot;</span></span>
<span id="cb29-2"><a href="starfield.html#cb29-2"></a></span>
<span id="cb29-3"><a href="starfield.html#cb29-3"></a><span class="pp">#include </span><span class="im">&lt;imgui.h&gt;</span></span>
<span id="cb29-4"><a href="starfield.html#cb29-4"></a></span>
<span id="cb29-5"><a href="starfield.html#cb29-5"></a><span class="pp">#include </span><span class="im">&lt;cppitertools/itertools.hpp&gt;</span></span>
<span id="cb29-6"><a href="starfield.html#cb29-6"></a><span class="pp">#include </span><span class="im">&lt;glm/gtx/fast_trigonometry.hpp&gt;</span></span>
<span id="cb29-7"><a href="starfield.html#cb29-7"></a></span>
<span id="cb29-8"><a href="starfield.html#cb29-8"></a><span class="dt">void</span> OpenGLWindow<span class="op">::</span>initializeGL<span class="op">()</span> <span class="op">{</span></span>
<span id="cb29-9"><a href="starfield.html#cb29-9"></a>  abcg<span class="op">::</span>glClearColor<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb29-10"><a href="starfield.html#cb29-10"></a></span>
<span id="cb29-11"><a href="starfield.html#cb29-11"></a>  <span class="co">// Enable depth buffering</span></span>
<span id="cb29-12"><a href="starfield.html#cb29-12"></a>  abcg<span class="op">::</span>glEnable<span class="op">(</span>GL_DEPTH_TEST<span class="op">);</span></span>
<span id="cb29-13"><a href="starfield.html#cb29-13"></a></span>
<span id="cb29-14"><a href="starfield.html#cb29-14"></a>  <span class="co">// Create program</span></span>
<span id="cb29-15"><a href="starfield.html#cb29-15"></a>  <span class="va">m_program</span> <span class="op">=</span> createProgramFromFile<span class="op">(</span>getAssetsPath<span class="op">()</span> <span class="op">+</span> <span class="st">&quot;depth.vert&quot;</span><span class="op">,</span></span>
<span id="cb29-16"><a href="starfield.html#cb29-16"></a>                                    getAssetsPath<span class="op">()</span> <span class="op">+</span> <span class="st">&quot;depth.frag&quot;</span><span class="op">);</span></span>
<span id="cb29-17"><a href="starfield.html#cb29-17"></a></span>
<span id="cb29-18"><a href="starfield.html#cb29-18"></a>  <span class="co">// Load model</span></span>
<span id="cb29-19"><a href="starfield.html#cb29-19"></a>  <span class="va">m_model</span><span class="op">.</span>loadObj<span class="op">(</span>getAssetsPath<span class="op">()</span> <span class="op">+</span> <span class="st">&quot;box.obj&quot;</span><span class="op">);</span></span>
<span id="cb29-20"><a href="starfield.html#cb29-20"></a></span>
<span id="cb29-21"><a href="starfield.html#cb29-21"></a>  <span class="va">m_model</span><span class="op">.</span>setupVAO<span class="op">(</span><span class="va">m_program</span><span class="op">);</span></span>
<span id="cb29-22"><a href="starfield.html#cb29-22"></a></span>
<span id="cb29-23"><a href="starfield.html#cb29-23"></a>  <span class="co">// Camera at (0,0,0) and looking towards the negative z</span></span>
<span id="cb29-24"><a href="starfield.html#cb29-24"></a>  <span class="va">m_viewMatrix</span> <span class="op">=</span></span>
<span id="cb29-25"><a href="starfield.html#cb29-25"></a>      glm<span class="op">::</span>lookAt<span class="op">(</span>glm<span class="op">::</span>vec3<span class="op">(</span><span class="fl">0.0</span><span class="bu">f</span><span class="op">,</span> <span class="fl">0.0</span><span class="bu">f</span><span class="op">,</span> <span class="fl">0.0</span><span class="bu">f</span><span class="op">),</span> glm<span class="op">::</span>vec3<span class="op">(</span><span class="fl">0.0</span><span class="bu">f</span><span class="op">,</span> <span class="fl">0.0</span><span class="bu">f</span><span class="op">,</span> <span class="op">-</span><span class="fl">1.0</span><span class="bu">f</span><span class="op">),</span></span>
<span id="cb29-26"><a href="starfield.html#cb29-26"></a>                  glm<span class="op">::</span>vec3<span class="op">(</span><span class="fl">0.0</span><span class="bu">f</span><span class="op">,</span> <span class="fl">1.0</span><span class="bu">f</span><span class="op">,</span> <span class="fl">0.0</span><span class="bu">f</span><span class="op">));</span></span>
<span id="cb29-27"><a href="starfield.html#cb29-27"></a></span>
<span id="cb29-28"><a href="starfield.html#cb29-28"></a>  <span class="co">// Setup stars</span></span>
<span id="cb29-29"><a href="starfield.html#cb29-29"></a>  <span class="cf">for</span> <span class="op">(</span><span class="at">const</span> <span class="kw">auto</span> index <span class="op">:</span> iter<span class="op">::</span>range<span class="op">(</span><span class="va">m_numStars</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb29-30"><a href="starfield.html#cb29-30"></a>    <span class="kw">auto</span> <span class="op">&amp;</span>position<span class="op">{</span><span class="va">m_starPositions</span><span class="op">.</span>at<span class="op">(</span>index<span class="op">)};</span></span>
<span id="cb29-31"><a href="starfield.html#cb29-31"></a>    <span class="kw">auto</span> <span class="op">&amp;</span>rotation<span class="op">{</span><span class="va">m_starRotations</span><span class="op">.</span>at<span class="op">(</span>index<span class="op">)};</span></span>
<span id="cb29-32"><a href="starfield.html#cb29-32"></a></span>
<span id="cb29-33"><a href="starfield.html#cb29-33"></a>    randomizeStar<span class="op">(</span>position<span class="op">,</span> rotation<span class="op">);</span></span>
<span id="cb29-34"><a href="starfield.html#cb29-34"></a>  <span class="op">}</span></span>
<span id="cb29-35"><a href="starfield.html#cb29-35"></a><span class="op">}</span></span></code></pre></div>
<p>Nas linhas 24 a 26 é definida a matriz de visão como uma câmera LookAt que está na origem do espaço do mundo e está olhando na direção do eixo <span class="math inline">\(z\)</span> negativo. Durante a execução, a câmera permanecerá fixa nessa posição e orientação. As estrelas (cubos) é que mudarão de posição para produzir o efeito de animação.</p>
<p>O laço das linhas 29 a 34 itera sobre cada elemento do arranjo <code>m_starPositions</code> e <code>m_starRotations</code>, e chama <code>OpenGLWindow::randomizeStar</code> para sortear uma posição inicial e eixo de rotação inicial para cada estrela.</p>
<p>A definição de <code>OpenGLWindow::randomizeStar</code> ficará como a seguir:</p>
<div class="sourceCode" id="cb30" startFrom="37"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 36;"><span id="cb30-37"><a href="starfield.html#cb30-37"></a><span class="dt">void</span> OpenGLWindow<span class="op">::</span>randomizeStar<span class="op">(</span>glm<span class="op">::</span>vec3 <span class="op">&amp;</span>position<span class="op">,</span> glm<span class="op">::</span>vec3 <span class="op">&amp;</span>rotation<span class="op">)</span> <span class="op">{</span></span>
<span id="cb30-38"><a href="starfield.html#cb30-38"></a>  <span class="co">// Get random position</span></span>
<span id="cb30-39"><a href="starfield.html#cb30-39"></a>  <span class="co">// x and y coordinates in the range [-20, 20]</span></span>
<span id="cb30-40"><a href="starfield.html#cb30-40"></a>  <span class="co">// z coordinates in the range [-100, 0]</span></span>
<span id="cb30-41"><a href="starfield.html#cb30-41"></a>  <span class="bu">std::</span>uniform_real_distribution<span class="op">&lt;</span><span class="dt">float</span><span class="op">&gt;</span> distPosXY<span class="op">(-</span><span class="fl">20.0</span><span class="bu">f</span><span class="op">,</span> <span class="fl">20.0</span><span class="bu">f</span><span class="op">);</span></span>
<span id="cb30-42"><a href="starfield.html#cb30-42"></a>  <span class="bu">std::</span>uniform_real_distribution<span class="op">&lt;</span><span class="dt">float</span><span class="op">&gt;</span> distPosZ<span class="op">(-</span><span class="fl">100.0</span><span class="bu">f</span><span class="op">,</span> <span class="fl">0.0</span><span class="bu">f</span><span class="op">);</span></span>
<span id="cb30-43"><a href="starfield.html#cb30-43"></a></span>
<span id="cb30-44"><a href="starfield.html#cb30-44"></a>  position <span class="op">=</span> glm<span class="op">::</span>vec3<span class="op">(</span>distPosXY<span class="op">(</span><span class="va">m_randomEngine</span><span class="op">),</span> distPosXY<span class="op">(</span><span class="va">m_randomEngine</span><span class="op">),</span></span>
<span id="cb30-45"><a href="starfield.html#cb30-45"></a>                       distPosZ<span class="op">(</span><span class="va">m_randomEngine</span><span class="op">));</span></span>
<span id="cb30-46"><a href="starfield.html#cb30-46"></a></span>
<span id="cb30-47"><a href="starfield.html#cb30-47"></a>  <span class="co">//  Get random rotation axis</span></span>
<span id="cb30-48"><a href="starfield.html#cb30-48"></a>  <span class="bu">std::</span>uniform_real_distribution<span class="op">&lt;</span><span class="dt">float</span><span class="op">&gt;</span> distRotAxis<span class="op">(-</span><span class="fl">1.0</span><span class="bu">f</span><span class="op">,</span> <span class="fl">1.0</span><span class="bu">f</span><span class="op">);</span></span>
<span id="cb30-49"><a href="starfield.html#cb30-49"></a></span>
<span id="cb30-50"><a href="starfield.html#cb30-50"></a>  rotation <span class="op">=</span> glm<span class="op">::</span>normalize<span class="op">(</span>glm<span class="op">::</span>vec3<span class="op">(</span>distRotAxis<span class="op">(</span><span class="va">m_randomEngine</span><span class="op">),</span></span>
<span id="cb30-51"><a href="starfield.html#cb30-51"></a>                                      distRotAxis<span class="op">(</span><span class="va">m_randomEngine</span><span class="op">),</span></span>
<span id="cb30-52"><a href="starfield.html#cb30-52"></a>                                      distRotAxis<span class="op">(</span><span class="va">m_randomEngine</span><span class="op">)));</span></span>
<span id="cb30-53"><a href="starfield.html#cb30-53"></a><span class="op">}</span></span></code></pre></div>
<p>Para a escolha da posição aleatória <span class="math inline">\((x,y,z)\)</span>:</p>
<ul>
<li>As coordenadas <span class="math inline">\(x\)</span> e <span class="math inline">\(y\)</span> são escolhidas do intervalo <span class="math inline">\([-20, 20]\)</span>;</li>
<li>A coordenada <span class="math inline">\(z\)</span> é escolhida do intervalo <span class="math inline">\([-100, 0]\)</span>.</li>
</ul>
<p>Assim, o campo estrelado é a região cuboide que vai de <span class="math inline">\((-20,-20,-100)\)</span> a <span class="math inline">\((20,20,0)\)</span>. Lembre-se que a câmera está em <span class="math inline">\(z=0\)</span>, olhando para <span class="math inline">\(z\)</span> negativo. Logo, a câmera pode enxergar potencialmente toda essa região, a depender das configurações de projeção.</p>
<p>Para a escolha do eixo de rotação aleatório, criamos um vetor com coordenadas aleatórias do intervalo <span class="math inline">\([-1,1]\)</span> em ponto flutuante e então normalizamos o vetor.</p>
<p>Vamos agora à definição de <code>OpenGLWindow::paintGL</code>:</p>
<div class="sourceCode" id="cb31" startFrom="55"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 54;"><span id="cb31-55"><a href="starfield.html#cb31-55"></a><span class="dt">void</span> OpenGLWindow<span class="op">::</span>paintGL<span class="op">()</span> <span class="op">{</span></span>
<span id="cb31-56"><a href="starfield.html#cb31-56"></a>  update<span class="op">();</span></span>
<span id="cb31-57"><a href="starfield.html#cb31-57"></a></span>
<span id="cb31-58"><a href="starfield.html#cb31-58"></a>  <span class="co">// Clear color buffer and depth buffer</span></span>
<span id="cb31-59"><a href="starfield.html#cb31-59"></a>  abcg<span class="op">::</span>glClear<span class="op">(</span>GL_COLOR_BUFFER_BIT <span class="op">|</span> GL_DEPTH_BUFFER_BIT<span class="op">);</span></span>
<span id="cb31-60"><a href="starfield.html#cb31-60"></a></span>
<span id="cb31-61"><a href="starfield.html#cb31-61"></a>  abcg<span class="op">::</span>glViewport<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="va">m_viewportWidth</span><span class="op">,</span> <span class="va">m_viewportHeight</span><span class="op">);</span></span>
<span id="cb31-62"><a href="starfield.html#cb31-62"></a></span>
<span id="cb31-63"><a href="starfield.html#cb31-63"></a>  abcg<span class="op">::</span>glUseProgram<span class="op">(</span><span class="va">m_program</span><span class="op">);</span></span>
<span id="cb31-64"><a href="starfield.html#cb31-64"></a></span>
<span id="cb31-65"><a href="starfield.html#cb31-65"></a>  <span class="co">// Get location of uniform variables (could be precomputed)</span></span>
<span id="cb31-66"><a href="starfield.html#cb31-66"></a>  <span class="at">const</span> GLint viewMatrixLoc<span class="op">{</span></span>
<span id="cb31-67"><a href="starfield.html#cb31-67"></a>      abcg<span class="op">::</span>glGetUniformLocation<span class="op">(</span><span class="va">m_program</span><span class="op">,</span> <span class="st">&quot;viewMatrix&quot;</span><span class="op">)};</span></span>
<span id="cb31-68"><a href="starfield.html#cb31-68"></a>  <span class="at">const</span> GLint projMatrixLoc<span class="op">{</span></span>
<span id="cb31-69"><a href="starfield.html#cb31-69"></a>      abcg<span class="op">::</span>glGetUniformLocation<span class="op">(</span><span class="va">m_program</span><span class="op">,</span> <span class="st">&quot;projMatrix&quot;</span><span class="op">)};</span></span>
<span id="cb31-70"><a href="starfield.html#cb31-70"></a>  <span class="at">const</span> GLint modelMatrixLoc<span class="op">{</span></span>
<span id="cb31-71"><a href="starfield.html#cb31-71"></a>      abcg<span class="op">::</span>glGetUniformLocation<span class="op">(</span><span class="va">m_program</span><span class="op">,</span> <span class="st">&quot;modelMatrix&quot;</span><span class="op">)};</span></span>
<span id="cb31-72"><a href="starfield.html#cb31-72"></a>  <span class="at">const</span> GLint colorLoc<span class="op">{</span>abcg<span class="op">::</span>glGetUniformLocation<span class="op">(</span><span class="va">m_program</span><span class="op">,</span> <span class="st">&quot;color&quot;</span><span class="op">)};</span></span>
<span id="cb31-73"><a href="starfield.html#cb31-73"></a></span>
<span id="cb31-74"><a href="starfield.html#cb31-74"></a>  <span class="co">// Set uniform variables used by every scene object</span></span>
<span id="cb31-75"><a href="starfield.html#cb31-75"></a>  abcg<span class="op">::</span>glUniformMatrix4fv<span class="op">(</span>viewMatrixLoc<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> GL_FALSE<span class="op">,</span> <span class="op">&amp;</span><span class="va">m_viewMatrix</span><span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb31-76"><a href="starfield.html#cb31-76"></a>  abcg<span class="op">::</span>glUniformMatrix4fv<span class="op">(</span>projMatrixLoc<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> GL_FALSE<span class="op">,</span> <span class="op">&amp;</span><span class="va">m_projMatrix</span><span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb31-77"><a href="starfield.html#cb31-77"></a>  abcg<span class="op">::</span>glUniform4f<span class="op">(</span>colorLoc<span class="op">,</span> <span class="fl">1.0</span><span class="bu">f</span><span class="op">,</span> <span class="fl">1.0</span><span class="bu">f</span><span class="op">,</span> <span class="fl">1.0</span><span class="bu">f</span><span class="op">,</span> <span class="fl">1.0</span><span class="bu">f</span><span class="op">);</span>  <span class="co">// White</span></span>
<span id="cb31-78"><a href="starfield.html#cb31-78"></a></span>
<span id="cb31-79"><a href="starfield.html#cb31-79"></a>  <span class="co">// Render each star</span></span>
<span id="cb31-80"><a href="starfield.html#cb31-80"></a>  <span class="cf">for</span> <span class="op">(</span><span class="at">const</span> <span class="kw">auto</span> index <span class="op">:</span> iter<span class="op">::</span>range<span class="op">(</span><span class="va">m_numStars</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb31-81"><a href="starfield.html#cb31-81"></a>    <span class="at">const</span> <span class="kw">auto</span> <span class="op">&amp;</span>position<span class="op">{</span><span class="va">m_starPositions</span><span class="op">.</span>at<span class="op">(</span>index<span class="op">)};</span></span>
<span id="cb31-82"><a href="starfield.html#cb31-82"></a>    <span class="at">const</span> <span class="kw">auto</span> <span class="op">&amp;</span>rotation<span class="op">{</span><span class="va">m_starRotations</span><span class="op">.</span>at<span class="op">(</span>index<span class="op">)};</span></span>
<span id="cb31-83"><a href="starfield.html#cb31-83"></a></span>
<span id="cb31-84"><a href="starfield.html#cb31-84"></a>    <span class="co">// Compute model matrix of the current star</span></span>
<span id="cb31-85"><a href="starfield.html#cb31-85"></a>    glm<span class="op">::</span>mat4 modelMatrix<span class="op">{</span><span class="fl">1.0</span><span class="bu">f</span><span class="op">};</span></span>
<span id="cb31-86"><a href="starfield.html#cb31-86"></a>    modelMatrix <span class="op">=</span> glm<span class="op">::</span>translate<span class="op">(</span>modelMatrix<span class="op">,</span> position<span class="op">);</span></span>
<span id="cb31-87"><a href="starfield.html#cb31-87"></a>    modelMatrix <span class="op">=</span> glm<span class="op">::</span>scale<span class="op">(</span>modelMatrix<span class="op">,</span> glm<span class="op">::</span>vec3<span class="op">(</span><span class="fl">0.2</span><span class="bu">f</span><span class="op">));</span></span>
<span id="cb31-88"><a href="starfield.html#cb31-88"></a>    modelMatrix <span class="op">=</span> glm<span class="op">::</span>rotate<span class="op">(</span>modelMatrix<span class="op">,</span> <span class="va">m_angle</span><span class="op">,</span> rotation<span class="op">);</span></span>
<span id="cb31-89"><a href="starfield.html#cb31-89"></a></span>
<span id="cb31-90"><a href="starfield.html#cb31-90"></a>    <span class="co">// Set uniform variable</span></span>
<span id="cb31-91"><a href="starfield.html#cb31-91"></a>    abcg<span class="op">::</span>glUniformMatrix4fv<span class="op">(</span>modelMatrixLoc<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> GL_FALSE<span class="op">,</span> <span class="op">&amp;</span>modelMatrix<span class="op">[</span><span class="dv">0</span><span class="op">][</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb31-92"><a href="starfield.html#cb31-92"></a></span>
<span id="cb31-93"><a href="starfield.html#cb31-93"></a>    <span class="va">m_model</span><span class="op">.</span>render<span class="op">();</span></span>
<span id="cb31-94"><a href="starfield.html#cb31-94"></a>  <span class="op">}</span></span>
<span id="cb31-95"><a href="starfield.html#cb31-95"></a></span>
<span id="cb31-96"><a href="starfield.html#cb31-96"></a>  abcg<span class="op">::</span>glUseProgram<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb31-97"><a href="starfield.html#cb31-97"></a><span class="op">}</span></span></code></pre></div>
<p>Logo no início, a função <code>OpenGLWindow::update</code> é chamada (linha 56) para atualizar a posição e rotação das estrelas de modo a produzir o efeito de animação.</p>
<p>Nas linhas 75 a 77 são definidos os valores das variáveis uniformes compartilhadas por todas as estrelas. Em particular, todas as estrelas usam a mesma matriz de visão e projeção. Além disso, todas usam a mesma cor (branca).</p>
<p>No laço da linha 80, cada estrela é renderizada. A matriz de modelo é construída nas linhas 84 a 88 usando as informações da estrela em <code>m_starPositions</code> e <code>m_starRotations</code>.</p>
<p>A matriz de modelo é copiada para o vertex shader na linha 91. Em seguida, na linha 93, a função <code>Model::render</code> é chamada para renderizar o objeto que representa a estrela, isto é, o cubo.</p>
<p>É importante observar que, embora o mesmo cubo seja renderizado 500 vezes, cada iteração utiliza uma matriz de modelo diferente. Podemos fazer isso pois todas as estrelas usam a mesma malha de triângulos (8 vértices e 12 triângulos). O que muda é a posição e orientação. Atributos como posição, orientação e escala da malha podem ser modificados no vertex shader por matrizes de transformação, que é o que estamos fazendo.</p>
<p>A definição de <code>OpenGLWindow::paintUI</code> ficará assim:</p>
<div class="sourceCode" id="cb32" startFrom="99"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 98;"><span id="cb32-99"><a href="starfield.html#cb32-99"></a><span class="dt">void</span> OpenGLWindow<span class="op">::</span>paintUI<span class="op">()</span> <span class="op">{</span></span>
<span id="cb32-100"><a href="starfield.html#cb32-100"></a>  abcg<span class="op">::</span>OpenGLWindow<span class="op">::</span>paintUI<span class="op">();</span></span>
<span id="cb32-101"><a href="starfield.html#cb32-101"></a></span>
<span id="cb32-102"><a href="starfield.html#cb32-102"></a>  <span class="op">{</span></span>
<span id="cb32-103"><a href="starfield.html#cb32-103"></a>    <span class="at">const</span> <span class="kw">auto</span> widgetSize<span class="op">{</span>ImVec2<span class="op">(</span><span class="dv">218</span><span class="op">,</span> <span class="dv">62</span><span class="op">)};</span></span>
<span id="cb32-104"><a href="starfield.html#cb32-104"></a>    ImGui<span class="op">::</span>SetNextWindowPos<span class="op">(</span>ImVec2<span class="op">(</span><span class="va">m_viewportWidth</span> <span class="op">-</span> widgetSize<span class="op">.</span>x <span class="op">-</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">5</span><span class="op">));</span></span>
<span id="cb32-105"><a href="starfield.html#cb32-105"></a>    ImGui<span class="op">::</span>SetNextWindowSize<span class="op">(</span>widgetSize<span class="op">);</span></span>
<span id="cb32-106"><a href="starfield.html#cb32-106"></a>    ImGui<span class="op">::</span>Begin<span class="op">(</span><span class="st">&quot;Widget window&quot;</span><span class="op">,</span> <span class="kw">nullptr</span><span class="op">,</span> ImGuiWindowFlags_NoDecoration<span class="op">);</span></span>
<span id="cb32-107"><a href="starfield.html#cb32-107"></a></span>
<span id="cb32-108"><a href="starfield.html#cb32-108"></a>    <span class="op">{</span></span>
<span id="cb32-109"><a href="starfield.html#cb32-109"></a>      ImGui<span class="op">::</span>PushItemWidth<span class="op">(</span><span class="dv">120</span><span class="op">);</span></span>
<span id="cb32-110"><a href="starfield.html#cb32-110"></a>      <span class="at">static</span> <span class="bu">std::</span>size_t<span class="op"> </span>currentIndex<span class="op">{};</span></span>
<span id="cb32-111"><a href="starfield.html#cb32-111"></a>      <span class="at">const</span> <span class="bu">std::</span>vector<span class="op">&lt;</span><span class="bu">std::</span>string<span class="op">&gt;</span> comboItems<span class="op">{</span><span class="st">&quot;Perspective&quot;</span><span class="op">,</span> <span class="st">&quot;Orthographic&quot;</span><span class="op">};</span></span>
<span id="cb32-112"><a href="starfield.html#cb32-112"></a></span>
<span id="cb32-113"><a href="starfield.html#cb32-113"></a>      <span class="cf">if</span> <span class="op">(</span>ImGui<span class="op">::</span>BeginCombo<span class="op">(</span><span class="st">&quot;Projection&quot;</span><span class="op">,</span></span>
<span id="cb32-114"><a href="starfield.html#cb32-114"></a>                            comboItems<span class="op">.</span>at<span class="op">(</span>currentIndex<span class="op">).</span>c_str<span class="op">()))</span> <span class="op">{</span></span>
<span id="cb32-115"><a href="starfield.html#cb32-115"></a>        <span class="cf">for</span> <span class="op">(</span><span class="at">const</span> <span class="kw">auto</span> index <span class="op">:</span> iter<span class="op">::</span>range<span class="op">(</span>comboItems<span class="op">.</span>size<span class="op">()))</span> <span class="op">{</span></span>
<span id="cb32-116"><a href="starfield.html#cb32-116"></a>          <span class="at">const</span> <span class="dt">bool</span> isSelected<span class="op">{</span>currentIndex <span class="op">==</span> index<span class="op">};</span></span>
<span id="cb32-117"><a href="starfield.html#cb32-117"></a>          <span class="cf">if</span> <span class="op">(</span>ImGui<span class="op">::</span>Selectable<span class="op">(</span>comboItems<span class="op">.</span>at<span class="op">(</span>index<span class="op">).</span>c_str<span class="op">(),</span> isSelected<span class="op">))</span></span>
<span id="cb32-118"><a href="starfield.html#cb32-118"></a>            currentIndex <span class="op">=</span> index<span class="op">;</span></span>
<span id="cb32-119"><a href="starfield.html#cb32-119"></a>          <span class="cf">if</span> <span class="op">(</span>isSelected<span class="op">)</span> ImGui<span class="op">::</span>SetItemDefaultFocus<span class="op">();</span></span>
<span id="cb32-120"><a href="starfield.html#cb32-120"></a>        <span class="op">}</span></span>
<span id="cb32-121"><a href="starfield.html#cb32-121"></a>        ImGui<span class="op">::</span>EndCombo<span class="op">();</span></span>
<span id="cb32-122"><a href="starfield.html#cb32-122"></a>      <span class="op">}</span></span>
<span id="cb32-123"><a href="starfield.html#cb32-123"></a>      ImGui<span class="op">::</span>PopItemWidth<span class="op">();</span></span>
<span id="cb32-124"><a href="starfield.html#cb32-124"></a></span>
<span id="cb32-125"><a href="starfield.html#cb32-125"></a>      ImGui<span class="op">::</span>PushItemWidth<span class="op">(</span><span class="dv">170</span><span class="op">);</span></span>
<span id="cb32-126"><a href="starfield.html#cb32-126"></a>      <span class="at">const</span> <span class="kw">auto</span> aspect<span class="op">{</span><span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">float</span><span class="op">&gt;(</span><span class="va">m_viewportWidth</span><span class="op">)</span> <span class="op">/</span></span>
<span id="cb32-127"><a href="starfield.html#cb32-127"></a>                        <span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">float</span><span class="op">&gt;(</span><span class="va">m_viewportHeight</span><span class="op">)};</span></span>
<span id="cb32-128"><a href="starfield.html#cb32-128"></a>      <span class="cf">if</span> <span class="op">(</span>currentIndex <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb32-129"><a href="starfield.html#cb32-129"></a>        <span class="va">m_projMatrix</span> <span class="op">=</span></span>
<span id="cb32-130"><a href="starfield.html#cb32-130"></a>            glm<span class="op">::</span>perspective<span class="op">(</span>glm<span class="op">::</span>radians<span class="op">(</span><span class="va">m_FOV</span><span class="op">),</span> aspect<span class="op">,</span> <span class="fl">0.01</span><span class="bu">f</span><span class="op">,</span> <span class="fl">100.0</span><span class="bu">f</span><span class="op">);</span></span>
<span id="cb32-131"><a href="starfield.html#cb32-131"></a></span>
<span id="cb32-132"><a href="starfield.html#cb32-132"></a>        ImGui<span class="op">::</span>SliderFloat<span class="op">(</span><span class="st">&quot;FOV&quot;</span><span class="op">,</span> <span class="op">&amp;</span><span class="va">m_FOV</span><span class="op">,</span> <span class="fl">5.0</span><span class="bu">f</span><span class="op">,</span> <span class="fl">179.0</span><span class="bu">f</span><span class="op">,</span> <span class="st">&quot;</span><span class="sc">%.0f</span><span class="st"> degrees&quot;</span><span class="op">);</span></span>
<span id="cb32-133"><a href="starfield.html#cb32-133"></a>      <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb32-134"><a href="starfield.html#cb32-134"></a>        <span class="va">m_projMatrix</span> <span class="op">=</span> glm<span class="op">::</span>ortho<span class="op">(-</span><span class="fl">20.0</span><span class="bu">f</span> <span class="op">*</span> aspect<span class="op">,</span> <span class="fl">20.0</span><span class="bu">f</span> <span class="op">*</span> aspect<span class="op">,</span> <span class="op">-</span><span class="fl">20.0</span><span class="bu">f</span><span class="op">,</span></span>
<span id="cb32-135"><a href="starfield.html#cb32-135"></a>                                  <span class="fl">20.0</span><span class="bu">f</span><span class="op">,</span> <span class="fl">0.01</span><span class="bu">f</span><span class="op">,</span> <span class="fl">100.0</span><span class="bu">f</span><span class="op">);</span></span>
<span id="cb32-136"><a href="starfield.html#cb32-136"></a>      <span class="op">}</span></span>
<span id="cb32-137"><a href="starfield.html#cb32-137"></a>      ImGui<span class="op">::</span>PopItemWidth<span class="op">();</span></span>
<span id="cb32-138"><a href="starfield.html#cb32-138"></a>    <span class="op">}</span></span>
<span id="cb32-139"><a href="starfield.html#cb32-139"></a></span>
<span id="cb32-140"><a href="starfield.html#cb32-140"></a>    ImGui<span class="op">::</span>End<span class="op">();</span></span>
<span id="cb32-141"><a href="starfield.html#cb32-141"></a>  <span class="op">}</span></span>
<span id="cb32-142"><a href="starfield.html#cb32-142"></a><span class="op">}</span></span></code></pre></div>
<p>Esse é o código que define os widgets da ImGui. Assim como fizemos no projeto anterior, a matriz de projeção (<code>m_projMatrix</code>) é definida como projeção perspectiva ou ortográfica de acordo com a seleção do usuário.</p>
<p>O restante de <code>openglwindow.cpp</code> ficará assim:</p>
<div class="sourceCode" id="cb33" startFrom="144"><pre class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp" style="counter-reset: source-line 143;"><span id="cb33-144"><a href="starfield.html#cb33-144"></a><span class="dt">void</span> OpenGLWindow<span class="op">::</span>resizeGL<span class="op">(</span><span class="dt">int</span> width<span class="op">,</span> <span class="dt">int</span> height<span class="op">)</span> <span class="op">{</span></span>
<span id="cb33-145"><a href="starfield.html#cb33-145"></a>  <span class="va">m_viewportWidth</span> <span class="op">=</span> width<span class="op">;</span></span>
<span id="cb33-146"><a href="starfield.html#cb33-146"></a>  <span class="va">m_viewportHeight</span> <span class="op">=</span> height<span class="op">;</span></span>
<span id="cb33-147"><a href="starfield.html#cb33-147"></a><span class="op">}</span></span>
<span id="cb33-148"><a href="starfield.html#cb33-148"></a></span>
<span id="cb33-149"><a href="starfield.html#cb33-149"></a><span class="dt">void</span> OpenGLWindow<span class="op">::</span>terminateGL<span class="op">()</span> <span class="op">{</span></span>
<span id="cb33-150"><a href="starfield.html#cb33-150"></a>  <span class="va">m_model</span><span class="op">.</span>terminateGL<span class="op">();</span></span>
<span id="cb33-151"><a href="starfield.html#cb33-151"></a>  abcg<span class="op">::</span>glDeleteProgram<span class="op">(</span><span class="va">m_program</span><span class="op">);</span></span>
<span id="cb33-152"><a href="starfield.html#cb33-152"></a><span class="op">}</span></span>
<span id="cb33-153"><a href="starfield.html#cb33-153"></a></span>
<span id="cb33-154"><a href="starfield.html#cb33-154"></a><span class="dt">void</span> OpenGLWindow<span class="op">::</span>update<span class="op">()</span> <span class="op">{</span></span>
<span id="cb33-155"><a href="starfield.html#cb33-155"></a>  <span class="co">// Animate angle by 90 degrees per second</span></span>
<span id="cb33-156"><a href="starfield.html#cb33-156"></a>  <span class="at">const</span> <span class="dt">float</span> deltaTime<span class="op">{</span><span class="kw">static_cast</span><span class="op">&lt;</span><span class="dt">float</span><span class="op">&gt;(</span>getDeltaTime<span class="op">())};</span></span>
<span id="cb33-157"><a href="starfield.html#cb33-157"></a>  <span class="va">m_angle</span> <span class="op">=</span> glm<span class="op">::</span>wrapAngle<span class="op">(</span><span class="va">m_angle</span> <span class="op">+</span> glm<span class="op">::</span>radians<span class="op">(</span><span class="fl">90.0</span><span class="bu">f</span><span class="op">)</span> <span class="op">*</span> deltaTime<span class="op">);</span></span>
<span id="cb33-158"><a href="starfield.html#cb33-158"></a></span>
<span id="cb33-159"><a href="starfield.html#cb33-159"></a>  <span class="co">// Update stars</span></span>
<span id="cb33-160"><a href="starfield.html#cb33-160"></a>  <span class="cf">for</span> <span class="op">(</span><span class="at">const</span> <span class="kw">auto</span> index <span class="op">:</span> iter<span class="op">::</span>range<span class="op">(</span><span class="va">m_numStars</span><span class="op">))</span> <span class="op">{</span></span>
<span id="cb33-161"><a href="starfield.html#cb33-161"></a>    <span class="kw">auto</span> <span class="op">&amp;</span>position<span class="op">{</span><span class="va">m_starPositions</span><span class="op">.</span>at<span class="op">(</span>index<span class="op">)};</span></span>
<span id="cb33-162"><a href="starfield.html#cb33-162"></a>    <span class="kw">auto</span> <span class="op">&amp;</span>rotation<span class="op">{</span><span class="va">m_starRotations</span><span class="op">.</span>at<span class="op">(</span>index<span class="op">)};</span></span>
<span id="cb33-163"><a href="starfield.html#cb33-163"></a></span>
<span id="cb33-164"><a href="starfield.html#cb33-164"></a>    <span class="co">// Z coordinate increases by 10 units per second</span></span>
<span id="cb33-165"><a href="starfield.html#cb33-165"></a>    position<span class="op">.</span>z <span class="op">+=</span> deltaTime <span class="op">*</span> <span class="fl">10.0</span><span class="bu">f</span><span class="op">;</span></span>
<span id="cb33-166"><a href="starfield.html#cb33-166"></a></span>
<span id="cb33-167"><a href="starfield.html#cb33-167"></a>    <span class="co">// If this star is behind the camera, select a new random position and</span></span>
<span id="cb33-168"><a href="starfield.html#cb33-168"></a>    <span class="co">// orientation, and move it back to -100</span></span>
<span id="cb33-169"><a href="starfield.html#cb33-169"></a>    <span class="cf">if</span> <span class="op">(</span>position<span class="op">.</span>z <span class="op">&gt;</span> <span class="fl">0.1</span><span class="bu">f</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb33-170"><a href="starfield.html#cb33-170"></a>      randomizeStar<span class="op">(</span>position<span class="op">,</span> rotation<span class="op">);</span></span>
<span id="cb33-171"><a href="starfield.html#cb33-171"></a>      position<span class="op">.</span>z <span class="op">=</span> <span class="op">-</span><span class="fl">100.0</span><span class="bu">f</span><span class="op">;</span>  <span class="co">// Back to -100</span></span>
<span id="cb33-172"><a href="starfield.html#cb33-172"></a>    <span class="op">}</span></span>
<span id="cb33-173"><a href="starfield.html#cb33-173"></a>  <span class="op">}</span></span>
<span id="cb33-174"><a href="starfield.html#cb33-174"></a><span class="op">}</span></span></code></pre></div>
<p>Em <code>OpenGLWindow::update</code>, incrementamos <code>m_angle</code> a uma taxa de <span class="math inline">\(90^\circ\)</span> por segundo (linha 157).</p>
<p>Além disso, iteramos sobre todas as estrelas no laço da linha 160. A coordenada <span class="math inline">\(z\)</span> da posição de cada estrela é incrementada a uma taxa de 10 unidades por segundo (linha 165). Assim, uma estrela que começa em <span class="math inline">\(z=-100\)</span> (distância máxima em relação à câmera) chega até <span class="math inline">\(z=0\)</span> (onde está a câmera) em 10 segundos.</p>
<p>A condicional da linha 169 verifica se a estrela já passou para trás da câmera. Verificamos se a coordenada <span class="math inline">\(z\)</span> da posição é maior que <span class="math inline">\(0.1\)</span> pois a estrela é um cubo unitário que foi reduzido em tamanho por um fator de escala <span class="math inline">\(0.2\)</span>. Logo, quando o cubo está em <span class="math inline">\(z=0\)</span> (isto é, na posição <span class="math inline">\(z\)</span> da câmera), ainda está com metade da malha triangular (metade do cubo) no espaço <span class="math inline">\(z&lt;0\)</span>. Isso significa que o cubo ainda pode ser visto pela câmera, pois a câmera está olhando na direção de <span class="math inline">\(z\)</span> negativo e a distância do plano de recorte próximo foi definida como <span class="math inline">\(0.01\)</span> (veja a chamada a <code>glm::perspective</code> na linha 130). Se <span class="math inline">\(z&gt;0.1\)</span>, então com certeza o cubo está totalmente atrás da câmera. Quando isso acontece, <code>OpenGLWindow::randomizeStar</code> é chamada novamente para sortear uma nova posição e eixo de rotação para a estrela. Além disso, a estrela é deslocada para <span class="math inline">\(z=-100\)</span> para começar um novo percurso em direção ao plano <span class="math inline">\(z=0\)</span> da câmera.</p>
<p>Isso conclui o projeto <code>starfield</code>!</p>
<p>Baixe o código completo usando <a href="https://hbatagelo.github.io/abcgapps/src/starfield.zip">este link</a>.</p>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="viewer1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="referências.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toc_float": true,
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
